<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create clusters based on dissimilarity matrix — PRE_FATE.speciesClustering_step1 • RFate</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Create clusters based on dissimilarity matrix — PRE_FATE.speciesClustering_step1" />

<meta property="og:description" content="This script is designed to create clusters of species based on
a distance matrix between those species. Several metrics are computed to
evaluate these clusters and a graphic is produced to help the user to choose
the best number of clusters (by subset of data if distance matrices are
given for each of them)." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../archive/RFate_0.0.1.9000.tar.gz">
    <span class="fa fa-rocket"></span>
     
    Download Current Version
  </a>
</li>
<li>
  <a href="https://github.com/MayaGueguen/RFate">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create clusters based on dissimilarity matrix</h1>
    <small>Source: <a href='https://github.com/MayaGueguen/RFate.git/blob/master/R/PRE_FATE.speciesClustering_step1.R'><code>R/PRE_FATE.speciesClustering_step1.R</code></a></small>
    </div>

    
    <p>This script is designed to create clusters of species based on
a distance matrix between those species. Several metrics are computed to
evaluate these clusters and a graphic is produced to help the user to choose
the best number of clusters (by subset of data if distance matrices are
given for each of them).</p>
    

    <pre class="usage"><span class='fu'>PRE_FATE.speciesClustering_step1</span>(<span class='no'>mat.species.DIST</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat.species.DIST</th>
      <td><p>a <code>dist</code> object corresponding to the distance
between each pair of species, or a <code>list</code> of <code>dist</code> objects, one
for each <code>GROUP</code> value. Such an object can be obtained with the
<code>PRE_FATE.speciesDistance</code> function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>list</code> object with 2 elements :</p>
<dl class='dl-horizontal'>
  <dt>clust.dendograms</dt><dd><p>a <code>list</code> object with as many objects of class
  <code>hclust</code> as subset of data</p></dd>
  <dt>clust.evaluation</dt><dd><p>a <code>data.frame</code> with 4 columns :
  <ul>
<li><p><code>group</code> : name of sub-dataset</p></li>
<li><p><code>nb.cluster</code> : number of clusters used for the clustering</p></li>
<li><p><code>variable</code> : evaluation metrics' name</p></li>
<li><p><code>value</code> : value of evaluation metric</p></li>
</ul></p></dd>
</dl>

<p>Two <code>PRE_FATE_CLUSTERING_[...].pdf</code> files are created :</p><dl class='dl-horizontal'>
  <dt><code class="file">STEP_1A <br /> clusteringMethod</code></dt><dd><p>to account for the chosen
  clustering method</p></dd>
  <dt><code class="file">STEP_1B <br /> numberOfClusters</code></dt><dd><p>for decision support, to help
  the user to choose the adequate number of clusters to be used into
  the <code>hclust</code> method</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function allows one to obtain dendograms based on a distance matrix
between species.</p>
<p>As for the <code>PRE_FATE.speciesDistance</code> method, clustering can be made
for sub-datasets, conditioning that <code>mat.species.DIST</code> parameter is
given as a <code>list</code> of <code>dist</code> object (instead of a <code>dist</code>
object alone).</p>
<p>The process is as follows :</p>
<dl class='dl-horizontal'>
  <dt><strong>1. Choice of the <br /> optimal <br /> clustering method</strong></dt><dd><p>hierarchical clustering on the dissimilarity matrix is realized with the
  <code>hclust</code> function.
  <ul>
<li><p>Several methods are available for the agglomeration : complete,
    ward.D, ward.D2, single, average (UPGMA), mcquitty (WPGMA), median
    (WPGMC) and centroid (UPGMC).</p></li>
<li><p>Mouchet et el. (2008) proposed of measure of similarity between
    the input distance and the one obtained with the clustering which must
    be minimized to help finding the best clustering method :
    $$ 1 - cor( input.DIST, clustering.DIST ) ^ 2$$</p></li>
</ul>
  <strong>For each agglomeration method, this measure is calculated. The
  method that minimizes it is kept and used for further analyses. A graphic
  (<code>STEP_1A</code>) is made to account for the comparison of these methods.</strong></p></dd>
    <dt><strong>2. Evaluation of the <br /> clustering</strong></dt><dd><p>once the hierarchical
  clustering is done, the number of clusters to keep should be chosen.
    To do that, several metrics are computed :
  <ul>
<li><p><em>Dunn index (<code>mdunn</code>) : </em>ratio of the smallest distance
    between observations not in the same cluster to the largest intra-cluster
    distance. Value between zero and infinity, and should be maximized.</p></li>
<li><p><em>Meila's Variation of Information index (<code>mVI</code>) : </em>
    measures the amount of information lost and gained in changing between
    2 clusterings. Should be minimized.</p></li>
<li><p><em>Coefficient of determination (<code>R2</code>) : </em>value between
    zero and one. Should be maximized.</p></li>
<li><p><em>Calinski and Harabasz index (<code>ch</code>) : </em>the higher
    the value, the "better" is the solution.</p></li>
<li><p><em>Corrected rand index (<code>Rand</code>) : </em>measures the
    similarity between two data clusterings. Value between 0 and 1, with 0
    indicating that the two data clusters do not agree on any pair of points
    and 1 indicating that the data clusters are exactly the same.</p></li>
<li><p><em>Average silhouette width (<code>av.sil</code>) : </em>Observations 
    with a large s(i) (almost 1) are very well clustered, a small s(i)
    (around 0) means that the observation lies between two clusters, and
    observations with a negative s(i) are probably placed in the wrong cluster.
    Should be maximized.</p></li>
</ul>
  <strong>A graphic (<code>STEP_1B</code>) is produced, giving the values of these
  metrics in function of the number of clusters used. Number of clusters with
  evaluation metrics' values among the 3 best are highlighted to help the user
  to make his/her optimal choice.</strong></p></dd>
</dl>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><strong>The function does not return ONE dendogram</strong> (or as many as given
dissimilarity structures) <strong>but a list with all tested numbers of clusters.</strong>
One final dendogram can then be obtained using this result as a parameter in
the <code>PRE_FATE.speciesClustering_step2</code> function.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='http://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></code>,
<code><a href='PRE_FATE.speciesDistance.html'>PRE_FATE.speciesDistance</a></code>,
<code><a href='PRE_FATE.speciesClustering_step2.html'>PRE_FATE.speciesClustering_step2</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load example data</span>
<span class='fu'>data</span>(<span class='no'>MontBlanc</span>)
<span class='fu'>str</span>(<span class='no'>MontBlanc</span>)</div><div class='output co'>#&gt; List of 3
#&gt;  $ mat.releves     :'data.frame':	12302 obs. of  4 variables:
#&gt;   ..$ sites  : int [1:12302] 660398 662913 663085 663104 663104 664839 751362 751377 751484 922672 ...
#&gt;   ..$ species: chr [1:12302] "Abies alba Miller" "Abies alba Miller" "Abies alba Miller" "Abies alba Miller" ...
#&gt;   ..$ abund  : Factor w/ 7 levels "","+","1","2",..: 2 2 2 3 6 4 2 3 2 2 ...
#&gt;   ..$ habitat: int [1:12302] 4 2 6 4 4 4 2 2 3 8 ...
#&gt;  $ mat.traits      :'data.frame':	337 obs. of  6 variables:
#&gt;   ..$ species     : chr [1:337] "X23" "X139" "X190" "X197" ...
#&gt;   ..$ Disp        : num [1:337] 4 5 7 6 7 1 4 7 7 7 ...
#&gt;   ..$ Light       : num [1:337] 2 2 3 3 5 3 5 5 5 3 ...
#&gt;   ..$ Height      : num [1:337] 1500 50 70 11 30 ...
#&gt;   ..$ Palatability: Factor w/ 5 levels "","0","1","2",..: 4 5 5 5 5 5 5 5 5 5 ...
#&gt;   ..$ GROUP       : Factor w/ 3 levels "C","H","P": 3 2 2 2 2 2 2 2 2 2 ...
#&gt;  $ mat.nicheOverlap: niolap [1:270, 1:270] NA 0.524 0.789 0.626 0.675 ...
#&gt;   ..- attr(*, "dimnames")=List of 2
#&gt;   .. ..$ : chr [1:270] "X10053" "X10106" "X10113" "X10182" ...
#&gt;   .. ..$ : chr [1:270] "X10053" "X10106" "X10113" "X10182" ...</div><div class='input'>
<span class='co'>## MontBlanc$mat.traits : data.frame</span>
<span class='co'>## MontBlanc$mat.nicheOverlap : niolap object</span>

<span class='co'>## Calculate distance between species</span>
<span class='no'>sp.DIST</span> <span class='kw'>=</span> <span class='fu'><a href='PRE_FATE.speciesDistance.html'>PRE_FATE.speciesDistance</a></span>(<span class='kw'>mat.species.traits</span> <span class='kw'>=</span> <span class='no'>MontBlanc</span>$<span class='no'>mat.traits</span>
                                   , <span class='kw'>mat.species.overlap</span> <span class='kw'>=</span> <span class='no'>MontBlanc</span>$<span class='no'>mat.nicheOverlap</span>
                                   , <span class='kw'>min.info.thresh</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)</div><div class='output co'>#&gt; 
#&gt;  ############## TRAIT INFORMATIONS ############## 
#&gt; 
#&gt;  Number of species :  337
#&gt;  Measured traits :  Disp, Light, Height, Palatability
#&gt;  Groups :  C, H, P
#&gt;  Number of species in each group :  48 271 18
#&gt; 
#&gt;  Number of species with traits :  337
#&gt;  Number of species with traits and no overlap information :  69
#&gt;  Number of species with overlap :  270
#&gt;  Number of species with overlap and no traits information :  2
#&gt; 
#&gt;  Comparison of groups' dimensions : 
#&gt; 
#&gt;  Group  1 :
#&gt; Trait distances :  48 48 
#&gt; Overlap distances :  38 38 
#&gt; 
#&gt;  Group  2 :
#&gt; Trait distances :  271 271 
#&gt; Overlap distances :  215 215 
#&gt; 
#&gt;  Group  3 :
#&gt; Trait distances :  18 18 
#&gt; Overlap distances :  15 15 
#&gt; 
#&gt;  Number of species with both trait and overlap distances:  268</div><div class='input'>
<span class='fu'>str</span>(<span class='no'>sp.DIST</span>)</div><div class='output co'>#&gt; List of 3
#&gt;  $ C:Class 'dist'  atomic [1:703] 0.0846 0.2436 0.1439 0.3741 0.038 ...
#&gt;   .. ..- attr(*, "Labels")= chr [1:38] "X10192" "X11256" "X12051" "X12060" ...
#&gt;   .. ..- attr(*, "Size")= int 38
#&gt;   .. ..- attr(*, "call")= language as.dist.default(m = mat)
#&gt;   .. ..- attr(*, "Diag")= logi FALSE
#&gt;   .. ..- attr(*, "Upper")= logi FALSE
#&gt;  $ H:Class 'dist'  atomic [1:23005] 0.232 0.165 0.262 0.273 0.24 ...
#&gt;   .. ..- attr(*, "Labels")= chr [1:215] "X10053" "X10106" "X10113" "X10182" ...
#&gt;   .. ..- attr(*, "Size")= int 215
#&gt;   .. ..- attr(*, "call")= language as.dist.default(m = mat)
#&gt;   .. ..- attr(*, "Diag")= logi FALSE
#&gt;   .. ..- attr(*, "Upper")= logi FALSE
#&gt;  $ P:Class 'dist'  atomic [1:105] 0.382 0.192 0.277 0.252 0.395 ...
#&gt;   .. ..- attr(*, "Labels")= chr [1:15] "X11313" "X11388" "X11726" "X11729" ...
#&gt;   .. ..- attr(*, "Size")= int 15
#&gt;   .. ..- attr(*, "call")= language as.dist.default(m = mat)
#&gt;   .. ..- attr(*, "Diag")= logi FALSE
#&gt;   .. ..- attr(*, "Upper")= logi FALSE</div><div class='input'>
<span class='co'>## Run hierarchical clustering and number of clusters' selection                      </span>
<span class='no'>sp.CLUST</span> <span class='kw'>=</span> <span class='fu'>PRE_FATE.speciesClustering_step1</span>(<span class='kw'>mat.species.DIST</span> <span class='kw'>=</span> <span class='no'>sp.DIST</span>)</div><div class='img'><img src='PRE_FATE.speciesClustering_step1-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt;  ############## CLUSTERING ############## 
#&gt; 
#&gt;  Clustering method :  average
#&gt;  Clustering evaluation...</div><div class='input'>
<span class='co'>## 2 .pdf files have been produced</span>
<span class='fu'>str</span>(<span class='no'>sp.CLUST</span>)</div><div class='img'><img src='PRE_FATE.speciesClustering_step1-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; List of 2
#&gt;  $ clust.dendograms:List of 3
#&gt;   ..$ C:List of 7
#&gt;   .. ..$ merge      : int [1:37, 1:2] -27 -8 -26 -17 -9 -29 -11 -25 -33 -3 ...
#&gt;   .. ..$ height     : num [1:37] 0.00661 0.00672 0.0078 0.01186 0.01203 ...
#&gt;   .. ..$ order      : int [1:38] 7 14 15 16 32 24 33 25 26 27 ...
#&gt;   .. ..$ labels     : chr [1:38] "X10192" "X11256" "X12051" "X12060" ...
#&gt;   .. ..$ method     : chr "average"
#&gt;   .. ..$ call       : language hclust(d = as.dist(x), method = clust.method)
#&gt;   .. ..$ dist.method: NULL
#&gt;   .. ..- attr(*, "class")= chr "hclust"
#&gt;   ..$ H:List of 7
#&gt;   .. ..$ merge      : int [1:214, 1:2] -5 -17 -188 -131 -160 -58 -169 -52 -82 -106 ...
#&gt;   .. ..$ height     : num [1:214] 0.00529 0.00662 0.0067 0.00718 0.00752 ...
#&gt;   .. ..$ order      : int [1:215] 27 81 129 208 29 166 78 79 95 165 ...
#&gt;   .. ..$ labels     : chr [1:215] "X10053" "X10106" "X10113" "X10182" ...
#&gt;   .. ..$ method     : chr "average"
#&gt;   .. ..$ call       : language hclust(d = as.dist(x), method = clust.method)
#&gt;   .. ..$ dist.method: NULL
#&gt;   .. ..- attr(*, "class")= chr "hclust"
#&gt;   ..$ P:List of 7
#&gt;   .. ..$ merge      : int [1:14, 1:2] -12 -5 -4 -9 -7 -1 2 -2 6 3 ...
#&gt;   .. ..$ height     : num [1:14] 0.0361 0.045 0.0489 0.0708 0.1343 ...
#&gt;   .. ..$ order      : int [1:15] 14 4 11 1 3 5 15 9 10 2 ...
#&gt;   .. ..$ labels     : chr [1:15] "X11313" "X11388" "X11726" "X11729" ...
#&gt;   .. ..$ method     : chr "average"
#&gt;   .. ..$ call       : language hclust(d = as.dist(x), method = clust.method)
#&gt;   .. ..$ dist.method: NULL
#&gt;   .. ..- attr(*, "class")= chr "hclust"
#&gt;  $ clust.evaluation:'data.frame':	234 obs. of  4 variables:
#&gt;   ..$ group     : Factor w/ 3 levels "C","H","P": 1 1 1 1 1 1 1 1 1 1 ...
#&gt;   ..$ nb.cluster: int [1:234] 2 3 4 5 6 7 8 9 10 11 ...
#&gt;   ..$ variable  : Factor w/ 6 levels "mdunn","mVI",..: 1 1 1 1 1 1 1 1 1 1 ...
#&gt;   ..$ value     : num [1:234] 0.379 0.399 0.613 0.613 0.67 ...</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Maya Guéguen

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Maya Guéguen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

