<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create clusters based on dissimilarity matrix — PRE_FATE.speciesClustering_step1 • RFate</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Create clusters based on dissimilarity matrix — PRE_FATE.speciesClustering_step1" />

<meta property="og:description" content="This script is designed to create clusters of species based on
a distance matrix between those species. Several metrics are computed to
evaluate these clusters and a graphic is produced to help the user to choose
the best number of clusters (by subset of data if distance matrices are
given for each of them)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li>
      <a href="../index.html#pre_fate---build-plant-functional-groups-pfg">
        <span class="fa fa-battery-quarter"></span>
         
        Build PFG
      </a>
    </li>
    <li>
      <a href="../index.html#pre_fate---build-parameter-files">
        <span class="fa fa-battery-half"></span>
         
        Build parameter files
      </a>
    </li>
    <li>
      <a href="../index.html#post_fate---evaluation-of-simulation">
        <span class="fa fa-battery-three-quarters"></span>
         
        Evaluate simulation
      </a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../archive/RFate_0.0.6.9000.tar.gz">
    <span class="fa fa-rocket fa-lg"></span>
     
    Download Current Version
  </a>
</li>
<li>
  <a href="https://github.com/MayaGueguen/RFate.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create clusters based on dissimilarity matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/MayaGueguen/RFate.git/blob/master/R/PRE_FATE.speciesClustering_step1.R'><code>R/PRE_FATE.speciesClustering_step1.R</code></a></small>
    <div class="hidden name"><code>PRE_FATE.speciesClustering_step1.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This script is designed to create clusters of species based on
a distance matrix between those species. Several metrics are computed to
evaluate these clusters and a graphic is produced to help the user to choose
the best number of clusters (by subset of data if distance matrices are
given for each of them).</p>
    
    </div>

    <pre class="usage"><span class='fu'>PRE_FATE.speciesClustering_step1</span>(<span class='no'>mat.species.DIST</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat.species.DIST</th>
      <td><p>a <code>dist</code> object corresponding to the distance
between each pair of species, or a <code>list</code> of <code>dist</code> objects, one
for each <code>GROUP</code> value. Such an object can be obtained with the
<code>PRE_FATE.speciesDistance</code> function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>list</code> object with 2 elements :</p>
<dl class='dl-horizontal'>
  <dt>clust.dendograms</dt><dd><p>a <code>list</code> object with as many objects of class
  <code>hclust</code> as subset of data</p></dd>
  <dt>clust.evaluation</dt><dd><p>a <code>data.frame</code> with 4 columns :
  <ul>
<li><p><code>group</code> : name of sub-dataset</p></li>
<li><p><code>nb.cluster</code> : number of clusters used for the clustering</p></li>
<li><p><code>variable</code> : evaluation metrics' name</p></li>
<li><p><code>value</code> : value of evaluation metric</p></li>
</ul></p></dd>
</dl>

<p>Two <code>PRE_FATE_CLUSTERING_[...].pdf</code> files are created :</p><dl class='dl-horizontal'>
  <dt><code class="file">STEP_1A <br /> clusteringMethod</code></dt><dd><p>to account for the chosen
  clustering method</p></dd>
  <dt><code class="file">STEP_1B <br /> numberOfClusters</code></dt><dd><p>for decision support, to help
  the user to choose the adequate number of clusters to be used into
  the <code>hclust</code> method</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function allows one to obtain dendograms based on a distance matrix
between species.</p>
<p>As for the <code>PRE_FATE.speciesDistance</code> method, clustering can be made
for sub-datasets, conditioning that <code>mat.species.DIST</code> parameter is
given as a <code>list</code> of <code>dist</code> object (instead of a <code>dist</code>
object alone).</p>
<p>The process is as follows :</p>
<dl class='dl-horizontal'>
  <dt><strong>1. Choice of the <br /> optimal <br /> clustering method</strong></dt><dd><p>hierarchical clustering on the dissimilarity matrix is realized with the
  <code>hclust</code> function.
  <ul>
<li><p>Several methods are available for the agglomeration : complete,
    ward.D, ward.D2, single, average (UPGMA), mcquitty (WPGMA), median
    (WPGMC) and centroid (UPGMC).</p></li>
<li><p>Mouchet et el. (2008) proposed of measure of similarity between
    the input distance and the one obtained with the clustering which must
    be minimized to help finding the best clustering method :
    $$ 1 - cor( input.DIST, clustering.DIST ) ^ 2$$</p></li>
</ul>
  <strong>For each agglomeration method, this measure is calculated. The
  method that minimizes it is kept and used for further analyses. A graphic
  (<code>STEP_1A</code>) is made to account for the comparison of these methods.</strong></p></dd>
    <dt><strong>2. Evaluation of the <br /> clustering</strong></dt><dd><p>once the hierarchical
  clustering is done, the number of clusters to keep should be chosen.
    To do that, several metrics are computed :
  <ul>
<li><p><em>Dunn index (<code>mdunn</code>) : </em>ratio of the smallest distance
    between observations not in the same cluster to the largest intra-cluster
    distance. Value between zero and infinity, and should be maximized.</p></li>
<li><p><em>Meila's Variation of Information index (<code>mVI</code>) : </em>
    measures the amount of information lost and gained in changing between
    2 clusterings. Should be minimized.</p></li>
<li><p><em>Coefficient of determination (<code>R2</code>) : </em>value between
    zero and one. Should be maximized.</p></li>
<li><p><em>Calinski and Harabasz index (<code>ch</code>) : </em>the higher
    the value, the "better" is the solution.</p></li>
<li><p><em>Corrected rand index (<code>Rand</code>) : </em>measures the
    similarity between two data clusterings. Value between 0 and 1, with 0
    indicating that the two data clusters do not agree on any pair of points
    and 1 indicating that the data clusters are exactly the same.</p></li>
<li><p><em>Average silhouette width (<code>av.sil</code>) : </em>Observations 
    with a large s(i) (almost 1) are very well clustered, a small s(i)
    (around 0) means that the observation lies between two clusters, and
    observations with a negative s(i) are probably placed in the wrong cluster.
    Should be maximized.</p></li>
</ul>
  <strong>A graphic (<code>STEP_1B</code>) is produced, giving the values of these
  metrics in function of the number of clusters used. Number of clusters with
  evaluation metrics' values among the 3 best are highlighted to help the user
  to make his/her optimal choice.</strong></p></dd>
</dl>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><strong>The function does not return ONE dendogram</strong> (or as many as given
dissimilarity structures) <strong>but a list with all tested numbers of clusters.</strong>
One final dendogram can then be obtained using this result as a parameter in
the <code>PRE_FATE.speciesClustering_step2</code> function.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></code>,
<code><a href='PRE_FATE.speciesDistance.html'>PRE_FATE.speciesDistance</a></code>,
<code><a href='PRE_FATE.speciesClustering_step2.html'>PRE_FATE.speciesClustering_step2</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## Load example data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>MontBlanc</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>MontBlanc</span>)

<span class='co'>## MontBlanc$mat.traits : data.frame</span>
<span class='co'>## MontBlanc$mat.nicheOverlap : niolap object</span>

<span class='co'>## Calculate distance between species</span>
<span class='no'>sp.DIST</span> <span class='kw'>=</span> <span class='fu'><a href='PRE_FATE.speciesDistance.html'>PRE_FATE.speciesDistance</a></span>(<span class='kw'>mat.species.traits</span> <span class='kw'>=</span> <span class='no'>MontBlanc</span>$<span class='no'>mat.traits</span>
                                   , <span class='kw'>mat.species.overlap</span> <span class='kw'>=</span> <span class='no'>MontBlanc</span>$<span class='no'>mat.nicheOverlap</span>
                                   , <span class='kw'>min.info.thresh</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>sp.DIST</span>)

<span class='co'>## Run hierarchical clustering and number of clusters' selection                      </span>
<span class='no'>sp.CLUST</span> <span class='kw'>=</span> <span class='fu'>PRE_FATE.speciesClustering_step1</span>(<span class='kw'>mat.species.DIST</span> <span class='kw'>=</span> <span class='no'>sp.DIST</span>)

<span class='co'>## 2 .pdf files have been produced</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>sp.CLUST</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Maya Guéguen</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Maya Guéguen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

